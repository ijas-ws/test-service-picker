import { createProxy, getVariables2 } from "../util/index.js";
export const Config = /* @__PURE__ */ createProxy("Config");
const metadata = parseMetadataEnvironment();
const parameters = flattenValues(getVariables2("Parameter"));
const secrets = flattenValues(getVariables2("Secret"));
Object.assign(Config, metadata, parameters, secrets);
///////////////
// Functions
///////////////
function parseMetadataEnvironment() {
    // If SST_APP and SST_STAGE are not set, it is likely the
    // user is using an older version of SST.
    const errorMsg = "This is usually the case when you are using an older version of SST. Please update SST to the latest version to use the SST Config feature.";
    if (!process.env.SST_APP) {
        throw new Error(`Cannot find the SST_APP environment variable. ${errorMsg}`);
    }
    if (!process.env.SST_STAGE) {
        throw new Error(`Cannot find the SST_STAGE environment variable. ${errorMsg}`);
    }
    return {
        APP: process.env.SST_APP,
        STAGE: process.env.SST_STAGE,
    };
}
function flattenValues(configValues) {
    const acc = {};
    Object.keys(configValues).forEach((name) => {
        acc[name] = configValues[name].value;
    });
    return acc;
}
